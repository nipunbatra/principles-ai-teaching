# Neural Network for Object Detection (Multi-task)

direction: right

vars: {
  primary: "#1e3a5f"
  success: "#2a9d8f"
  warning: "#FF9800"
  accent: "#e85a4f"
  fill-primary: "#E3F2FD"
  fill-success: "#E8F5E9"
  fill-success-mid: "#C8E6C9"
  fill-warning: "#FFF8E1"
  fill-accent: "#FFEBEE"
}

input: {
  label: |md
    **INPUT**

    Image (416Ã—416)
    $\mathbf{I} \in \mathbb{R}^{H \times W \times 3}$
  |
  shape: rectangle
  style.fill: ${fill-primary}
  style.stroke: ${primary}
  style.stroke-width: 2
  style.font-size: 14
}

backbone: {
  label: |md
    **CNN BACKBONE**

    Extract multi-scale
    feature maps
  |
  shape: rectangle
  style.fill: ${fill-warning}
  style.stroke: ${warning}
  style.stroke-width: 2
  style.font-size: 14
}

head: {
  label: "DETECTION HEAD"
  style.fill: ${fill-success}
  style.stroke: ${success}
  style.stroke-width: 2
  style.font-size: 12

  box: {
    label: |md
      **Box**
      $(x, y, w, h)$
    |
    shape: rectangle
    style.fill: ${fill-success-mid}
    style.font-size: 12
  }
  obj: {
    label: |md
      **Objectness**
      $\sigma(o)$
    |
    shape: rectangle
    style.fill: ${fill-success-mid}
    style.font-size: 12
  }
  cls: {
    label: |md
      **Classes**
      softmax
    |
    shape: rectangle
    style.fill: ${fill-success-mid}
    style.font-size: 12
  }
}

result: {
  label: |md
    **PREDICTIONS**

    Dog: 95%
    Box: $[x, y, w, h]$
  |
  shape: rectangle
  style.fill: ${fill-accent}
  style.stroke: ${accent}
  style.stroke-width: 2
  style.font-size: 14
}

input -> backbone: Conv {
  style.stroke: ${primary}
  style.font-size: 12
}
backbone -> head: Features {
  style.stroke: ${warning}
  style.font-size: 12
}
head -> result: NMS {
  style.stroke: ${success}
  style.font-size: 12
}
